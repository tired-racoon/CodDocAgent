## ClassDef ChatEngine
**ChatEngine**: Функция ChatEngine представляет собой класс для взаимодействия с моделями машинного обучения, такими как OpenAI, Yagpt и Gigachat, для генерации текстовых ответов на основе предоставленных данных.

**Attributes**:
* параметр 1: `model_name` — имя модели машинного обучения, используемой для генерации ответов (по умолчанию «openai»).
* параметр 2: `temperature` — параметр, влияющий на «температуру» модели, определяющий степень креативности или точности генерируемого текста (по умолчанию 0.6).
* параметр 3: `project_manager` — менеджер проекта, используемый для управления процессом генерации ответов.

**Описание кода**:
Класс ChatEngine инициализируется с указанием модели машинного обучения (`model_name`), параметра `temperature` и менеджера проекта (`project_manager`). В зависимости от значения `model_name` класс создаёт соответствующий экземпляр модели для генерации ответов.

Если `model_name` равно «openai», класс создаёт экземпляр `OpenAILike` с использованием настроек, полученных из `SettingsManager`. Затем генерируется запрос к модели с использованием метода `chat()`.

Если `model_name` не равно «openai», «yagpt» или «gigachat», возникает ошибка `ValueError`.

Метод `build_prompt` создаёт строку с инструкциями для модели на основе переданного объекта `DocItem`. Метод `generate_doc` генерирует ответ модели на основе инструкций, созданных методом `build_prompt`.

**Примечание**:
При использовании класса ChatEngine необходимо убедиться, что модель, указанная в `model_name`, поддерживается. Также необходимо предоставить соответствующие настройки для модели, такие как API-ключ и URL-адрес API.

**Output Example**:
Пример вывода может включать в себя сгенерированный ответ модели, а также информацию о количестве использованных токенов.
### FunctionDef __init__(self, project_manager, model_name, temperature)
**__init__**: Функция `__init__` инициализирует объект класса `ChatEngine`, задавая параметры для работы с моделью искусственного интеллекта.

**parameters**:
* параметр 1: `project_manager` — объект, который управляет проектом.
* параметр 2: `model_name` (по умолчанию `"openai"`) — название модели искусственного интеллекта.
* параметр 3: `temperature` (по умолчанию `0.6`) — параметр, влияющий на степень случайности генерируемого ответа модели.

**Описание кода**:
Функция `__init__` принимает три параметра и инициализирует соответствующие атрибуты объекта. Название модели приводится к нижнему регистру. Затем выводится сообщение в лог с указанием заданного названия модели.

В зависимости от значения `model_name` происходит следующее:
* Если `model_name` равно `"openai"`, то создаётся экземпляр класса `OpenAILike` с заданными параметрами. Для этого используются настройки из `SettingsManager`.
* Если `model_name` не равно `"yagpt"` или `"gigachat"`, то поднимается исключение `ValueError` с указанием на неподдерживаемую модель.

**Примечание**:
При использовании данной функции необходимо убедиться, что настройки для работы с моделью (`SettingsManager`) доступны и корректны. Также важно учитывать, что некоторые модели могут требовать дополнительных настроек или иметь ограничения по использованию.
***
### FunctionDef build_prompt(self)
**build_prompt**: Функция `build_prompt` формирует текстовый запрос (промпт) для дальнейшей обработки моделью искусственного интеллекта, включая информацию о вызываемых и вызывающих объектах, типе и имени кода, его содержимом и других параметрах.

**parameters**:
* параметр 1: `doc_item: DocItem` — объект, содержащий информацию о коде, включая его содержание, ссылки на вызываемые и вызывающие объекты и т. д.

**Описание кода**:
Функция `build_prompt` получает на вход объект `doc_item` и выполняет следующие действия:
* извлекает информацию о коде из `doc_item`;
* использует вспомогательные функции `get_referenced_prompt` и `get_referencer_prompt` для получения списков объектов, которые вызывает текущий код, и объектов, которые его вызывают;
* формирует описание отношений между текущим кодом и его объектами-вызывающими и вызываемыми с помощью функции `get_relationship_description`;
* объединяет все полученные данные в единый промпт с помощью `chat_template.format_messages`.

В функции используются следующие вспомогательные функции:
* `get_referenced_prompt` — возвращает строку с описанием объектов, которые вызывает текущий код;
* `get_referencer_prompt` — возвращает строку с описанием объектов, которые вызывают текущий код;
* `get_relationship_description` — возвращает строку с описанием отношений между текущим кодом и его объектами-вызывающими и вызываемыми.

**Примечание**:
При использовании функции `build_prompt` необходимо учитывать иерархическую структуру проекта, чтобы правильно формировать промпты для моделей искусственного интеллекта. Также важно правильно интерпретировать параметры функции и данные, передаваемые в неё, чтобы избежать ошибок при формировании промптов.

**Output Example**:
Пример вывода функции `build_prompt` может включать в себя информацию о типе и имени кода, его содержимом, объектах, которые его вызывают и которые он вызывает, а также описание отношений между ними.
***
### FunctionDef generate_doc(self)
**generate_doc**: Функция `generate_doc` формирует запрос для модели искусственного интеллекта на основе переданного объекта `doc_item` и возвращает ответ от модели.

**parameters**:
* параметр 1: `doc_item: DocItem` — объект, содержащий информацию о коде, включая его содержание, ссылки на вызываемые и вызывающие объекты и т. д.

**Описание кода**:
Функция `generate_doc` выполняет следующие действия:
* получает на вход объект `doc_item`;
* формирует текстовый запрос (промпт) для дальнейшей обработки моделью искусственного интеллекта с помощью функции `build_prompt`;
* объединяет все полученные данные в единый промпт;
* в зависимости от значения `self.model_name` отправляет промпт на обработку соответствующей модели (`openai`, `yagpt` или `gigachat`);
* возвращает ответ от модели.

Если модель `openai`, то функция `generate_doc` вызывает метод `chat` для отправки промптов и возвращает ответ в виде строки с содержанием сообщения. Если модель `yagpt` или `gigachat`, то функция вызывает соответствующие функции `yandex_gpt` и `gigachat_gpt` и возвращает ответ.

В случае возникновения ошибки при вызове модели, функция выводит сообщение об ошибке в логгер и вызывает исключение.

**Примечание**:
При использовании функции `generate_doc` необходимо учитывать иерархическую структуру проекта, чтобы правильно формировать промпты для моделей искусственного интеллекта. Также важно правильно интерпретировать параметры функции и данные, передаваемые в неё, чтобы избежать ошибок при формировании промптов.

**Output Example**:
Пример вывода функции `generate_doc` может включать в себя ответ от модели искусственного интеллекта на сформированный запрос.
***
